(function(global,factory){typeof exports=="object"&&typeof module!="undefined"?module.exports=factory():typeof define=="function"&&define.amd?define(factory):(global=typeof globalThis!="undefined"?globalThis:global||self,global.lgHash=factory())})(this,function(){"use strict";var __assign=function(){return __assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},__assign.apply(this,arguments)},lGEvents={afterAppendSlide:"lgAfterAppendSlide",init:"lgInit",hasVideo:"lgHasVideo",containerResize:"lgContainerResize",updateSlides:"lgUpdateSlides",afterAppendSubHtml:"lgAfterAppendSubHtml",beforeOpen:"lgBeforeOpen",afterOpen:"lgAfterOpen",slideItemLoad:"lgSlideItemLoad",beforeSlide:"lgBeforeSlide",afterSlide:"lgAfterSlide",posterClick:"lgPosterClick",dragStart:"lgDragStart",dragMove:"lgDragMove",dragEnd:"lgDragEnd",beforeNextSlide:"lgBeforeNextSlide",beforePrevSlide:"lgBeforePrevSlide",beforeClose:"lgBeforeClose",afterClose:"lgAfterClose",rotateLeft:"lgRotateLeft",rotateRight:"lgRotateRight",flipHorizontal:"lgFlipHorizontal",flipVertical:"lgFlipVertical",autoplay:"lgAutoplay",autoplayStart:"lgAutoplayStart",autoplayStop:"lgAutoplayStop"},hashSettings={hash:!0,galleryId:"1",customSlideName:!1},Hash=function(){function Hash(instance,$LG){return this.core=instance,this.$LG=$LG,this.settings=__assign(__assign({},hashSettings),this.core.settings),this}return Hash.prototype.init=function(){var _this=this;if(!this.settings.hash)return;this.oldHash=window.location.hash,setTimeout(function(){_this.buildFromHash()},100),this.core.LGel.on(lGEvents.afterSlide+".hash",this.onAfterSlide.bind(this)),this.core.LGel.on(lGEvents.afterClose+".hash",this.onCloseAfter.bind(this)),this.$LG(window).on("hashchange.lg.hash.global"+this.core.lgId,this.onHashchange.bind(this))},Hash.prototype.onAfterSlide=function(event){var slideName=this.core.galleryItems[event.detail.index].slideName;slideName=this.settings.customSlideName?slideName||event.detail.index:event.detail.index,history.replaceState?history.replaceState(null,"",window.location.pathname+window.location.search+"#lg="+this.settings.galleryId+"&slide="+slideName):window.location.hash="lg="+this.settings.galleryId+"&slide="+slideName},Hash.prototype.getIndexFromUrl=function(hash){hash===void 0&&(hash=window.location.hash);var slideName=hash.split("&slide=")[1],_idx=0;if(this.settings.customSlideName)for(var index=0;index<this.core.galleryItems.length;index++){var dynamicEl=this.core.galleryItems[index];if(dynamicEl.slideName===slideName){_idx=index;break}}else _idx=parseInt(slideName,10);return isNaN(_idx)?0:_idx},Hash.prototype.buildFromHash=function(){var _hash=window.location.hash;if(_hash.indexOf("lg="+this.settings.galleryId+"&")>0){this.$LG(document.body).addClass("lg-from-hash");var index=this.getIndexFromUrl(_hash);return this.core.openGallery(index),!0}},Hash.prototype.onCloseAfter=function(){this.oldHash&&this.oldHash.indexOf("lg="+this.settings.galleryId)<0?history.replaceState?history.replaceState(null,"",this.oldHash):window.location.hash=this.oldHash:history.replaceState?history.replaceState(null,document.title,window.location.pathname+window.location.search):window.location.hash=""},Hash.prototype.onHashchange=function(){if(!this.core.lgOpened)return;var _hash=window.location.hash,index=this.getIndexFromUrl(_hash);_hash.indexOf("lg="+this.settings.galleryId)>-1?this.core.slide(index,!1,!1):this.core.lGalleryOn&&this.core.closeGallery()},Hash.prototype.closeGallery=function(){this.settings.hash&&this.$LG(document.body).removeClass("lg-from-hash")},Hash.prototype.destroy=function(){this.core.LGel.off(".lg.hash"),this.core.LGel.off(".hash"),this.$LG(window).off("hashchange.lg.hash.global"+this.core.lgId)},Hash}();return Hash})